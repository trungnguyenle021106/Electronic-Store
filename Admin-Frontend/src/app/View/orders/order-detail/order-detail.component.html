<h2 mat-dialog-title>Chi Tiết Đơn Hàng #{{ data.ID }}</h2>

<mat-dialog-content class="mat-typography">
    <div class="customer-info" *ngIf="customerInformation">
        <h3>Thông Tin Khách Hàng</h3>
        <mat-list>
            <mat-list-item>
                <span matListItemTitle>Email:</span>
                <span matListItemLine>{{ customerInformation.Email }}</span>
            </mat-list-item>
            <mat-list-item>
                <span matListItemTitle>Họ và Tên:</span>
                <span matListItemLine>{{ customerInformation.Name }}</span>
            </mat-list-item>
            <mat-list-item>
                <span matListItemTitle>Số Điện Thoại:</span>
                <span matListItemLine>{{ customerInformation.Phone }}</span>
            </mat-list-item>
            <mat-list-item>
                <span matListItemTitle>Địa Chỉ:</span>
                <span matListItemLine>{{ customerInformation.Address }}</span>
            </mat-list-item>
            <mat-list-item>
                <span matListItemTitle>Giới Tính:</span>
                <span matListItemLine>{{ customerInformation.Gender === 'male' ? 'Nam' : 'Nữ' }}</span>
            </mat-list-item>
        </mat-list>
    </div>
    <hr *ngIf="data.CustomerID">
    <div class="order-summary">
        <h3>Thông Tin Đơn Hàng</h3>
        <mat-list>
            <mat-list-item>
                <span matListItemTitle>Mã đơn hàng:</span>
                <span matListItemLine>{{ data.ID }}</span>
            </mat-list-item>
            <mat-list-item>
                <span matListItemTitle>Ngày đặt hàng:</span>
                <span matListItemLine>{{ data.OrderDate | date:'dd/MM/yyyy HH:mm:ss' }}</span>
            </mat-list-item>
            <mat-list-item>
                <span matListItemTitle>Trạng thái:</span>
                <span matListItemLine>{{data.Status }}</span>
            </mat-list-item>
            <mat-list-item>
                <span matListItemTitle>Tổng tiền đơn hàng:</span>
                <span matListItemLine>{{ data.Total | currency:'VND':'symbol':'1.0-0' }}</span>
            </mat-list-item>
        </mat-list>
    </div>
    <hr>

    <div class="order-items">
        <h3>Sản Phẩm Hóa Đơn</h3>
        <table mat-table [dataSource]="orderItems">
            <ng-container matColumnDef="No">
                <th mat-header-cell *matHeaderCellDef> # </th>
                <td mat-cell *matCellDef="let element; let i = index;"> {{i + 1}} </td>
            </ng-container>

            <ng-container matColumnDef="Image">
                <th mat-header-cell *matHeaderCellDef> Hình Ảnh </th>
                <td mat-cell *matCellDef="let element">
                    <img [src]="element.Product.Image || 'assets/placeholder.png'" alt="Sản phẩm"
                        class="product-thumbnail" />
                </td>
            </ng-container>

            <ng-container matColumnDef="ProductName">
                <th mat-header-cell *matHeaderCellDef> Tên Sản Phẩm </th>
                <td mat-cell *matCellDef="let element"> {{element.Product.Name}} </td>
            </ng-container>

            <ng-container matColumnDef="Quantity">
                <th mat-header-cell *matHeaderCellDef> Số Lượng </th>
                <td mat-cell *matCellDef="let element"> {{element.Quantity}} </td>
            </ng-container>

            <ng-container matColumnDef="UnitPrice">
                <th mat-header-cell *matHeaderCellDef> Giá </th>
                <td mat-cell *matCellDef="let element"> {{element.Product.Price | currency:'VND':'symbol':'1.0-0'}}
                </td>
            </ng-container>

            <ng-container matColumnDef="LineTotal">
                <th mat-header-cell *matHeaderCellDef> Tổng Giá </th>
                <td mat-cell *matCellDef="let element"> {{element.TotalPrice | currency:'VND':'symbol':'1.0-0'}} </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedOrderItemsColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedOrderItemsColumns;"></tr>
        </table>

        <p *ngIf="!orderItems || orderItems.length === 0" class="no-items-message">
            Đơn hàng này chưa có sản phẩm nào.
        </p>

    </div>
</mat-dialog-content>

<mat-dialog-actions align="end">
    <button mat-flat-button color="primary" (click)="onClose()">Đóng</button>
</mat-dialog-actions>