<div class="forget-password-container">
  <!-- Bước nhập email -->
  <div *ngIf="step === 1" class="step step-email">
    <h2 class="step-title">Quên mật khẩu</h2>
    <form [formGroup]="emailForm" (ngSubmit)="requestForgotPasswordCode()">
      <div class="form-group">
        <label for="email">Email:</label>
        <input
          id="email"
          type="email"
          formControlName="email"
          [class.invalid]="emailForm.get('email')?.invalid && emailForm.get('email')?.touched"
          placeholder="Nhập email của bạn"
        />
        <div *ngIf="emailForm.get('email')?.invalid && emailForm.get('email')?.touched" class="error">
          Vui lòng nhập email hợp lệ.
        </div>
      </div>
      <button type="submit" [disabled]="emailForm.invalid">Gửi mã xác thực</button>
    </form>
  </div>

  <!-- Bước xác thực mã -->
  <div *ngIf="step === 2" class="step step-verification">
    <h2 class="step-title">Xác thực mã</h2>
    <form [formGroup]="verificationForm" (ngSubmit)="verifyCodeAndResetPassword()">
      <div class="form-group">
        <label for="code">Mã xác thực:</label>
        <input
          id="code"
          type="text"
          formControlName="code"
          placeholder="Nhập mã xác thực"
        />
      </div>
      <div class="form-group">
        <label for="password">Mật khẩu mới:</label>
        <input
          id="password"
          type="password"
          formControlName="password"
          placeholder="Nhập mật khẩu mới"
        />
      </div>
      <div class="form-group">
        <label for="confirmPassword">Xác nhận mật khẩu:</label>
        <input
          id="confirmPassword"
          type="password"
          formControlName="confirmPassword"
          placeholder="Nhập lại mật khẩu"
        />
        <div *ngIf="verificationForm.hasError('notMatching')" class="error">
          Mật khẩu không khớp.
        </div>
      </div>
      <button type="submit" [disabled]="verificationForm.invalid">Đổi mật khẩu</button>

      <!-- Nút gửi lại mã -->
      <button
        type="button"
        (click)="resendVerificationCode()"
        [disabled]="isResendDisabled"
        class="resend-btn"
      >
        Gửi lại mã xác thực
        <span *ngIf="isResendDisabled">({{ resendTimer }}s)</span>
      </button>

      <button type="button" (click)="goBackToEmailStep()" class="back-btn">Quay lại</button>
    </form>
  </div>

  <!-- Bước hoàn tất -->
  <div *ngIf="step === 3" class="step step-complete">
    <h2 class="step-title">Thành công!</h2>
    <p>Mật khẩu của bạn đã được đặt lại thành công.</p>
    <button class="back-btn" (click)="goBackToEmailStep()">Quay lại</button>
  </div>
</div>